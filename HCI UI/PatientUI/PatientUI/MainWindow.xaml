<Window x:Class="TuioPatientUI.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="Medication System" Height="900" Width="800">
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="400" />
        </Grid.ColumnDefinitions>

        <!-- Main Content Area -->
        <StackPanel Grid.Column="0" Margin="20">
            <TextBlock Text="Medication System" FontSize="24" FontWeight="Bold"
                Margin="0,0,0,20" />

            <!-- Current State Display -->
            <GroupBox Header="Current Status" Margin="0,0,0,20">
                <StackPanel>
                    <TextBlock x:Name="InstructionText" Text="Place rotate marker to begin"
                        FontSize="16" Margin="10" />
                    <TextBlock x:Name="ModeText" Text="Mode: Idle" FontSize="14" Margin="10" />
                    <TextBlock x:Name="SelectedMedText" Text="Selected: —" FontSize="14" Margin="10" />
                    <TextBlock x:Name="NextDoseText" Text="No upcoming doses" FontSize="14"
                        Margin="10" FontWeight="Bold" />
                </StackPanel>
            </GroupBox>

            <!-- Medication Wheel -->
            <Canvas x:Name="WheelCanvas" Width="420" Height="420" Background="LightGray"
                Visibility="Collapsed" HorizontalAlignment="Center">
                <!-- Wheel will be drawn programmatically -->
            </Canvas>

            <!-- Confirmation Popup -->
            <Border x:Name="Popup" Visibility="Collapsed" Background="White" BorderBrush="Black"
                BorderThickness="2" Padding="20" Margin="0,20,0,0" HorizontalAlignment="Center">
                <StackPanel>
                    <TextBlock x:Name="PopupText" Text="Did you take the medication?" FontSize="18"
                        FontWeight="Bold" Margin="0,0,0,10" TextAlignment="Center" />
                    <TextBlock Text="Use rotate marker: left side = YES, right side = NO"
                        FontSize="14" Margin="0,10,0,0" TextAlignment="Center" />
                </StackPanel>
            </Border>
        </StackPanel>

        <!-- Right Panel -->
        <StackPanel Grid.Column="1" Margin="10">
            <!-- Medication Schedule -->
            <GroupBox Header="Medication Schedule" Margin="0,0,0,10">
                <StackPanel>
                    <TextBlock x:Name="StatusText" Text="Disconnected" Margin="5" Foreground="Red" />
                    <ScrollViewer Height="500" VerticalScrollBarVisibility="Auto">
                        <StackPanel x:Name="SchedulePanel" Margin="5">
                            <!-- Medication schedules will be populated here -->
                        </StackPanel>
                    </ScrollViewer>
                </StackPanel>
            </GroupBox>

            <!-- Activity Log (Hidden for Patient, Visible in Debug/Nurse Mode) -->
            <GroupBox x:Name="ActivityLogGroup" Header="Activity Log" Margin="0,0,0,10"
                Visibility="Collapsed">
                <StackPanel>
                    <ListBox x:Name="LogList" Height="150" FontFamily="Consolas" FontSize="9" />
                </StackPanel>
            </GroupBox>
        </StackPanel>

        <!-- Patient Information Panel Overlay (Nurse Mode) -->
        <Border x:Name="PatientInfoPanel" Grid.Column="0" Visibility="Collapsed"
            Background="White" BorderBrush="DodgerBlue" BorderThickness="3"
            Padding="20" Margin="20" VerticalAlignment="Stretch">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    <TextBlock x:Name="PatientInfoTitle" Text="PATIENT INFORMATION"
                        FontSize="24" FontWeight="Bold" Margin="0,0,0,20"
                        TextAlignment="Center" Foreground="DodgerBlue" />
                    <TextBlock x:Name="PatientInfoContent" FontSize="13"
                        FontFamily="Consolas" TextWrapping="Wrap" Margin="0,0,0,20" />
                    <TextBlock Text="Press marker 12 (BACK) to return to wheel"
                        FontSize="14" FontWeight="Bold" TextAlignment="Center"
                        Foreground="Gray" Padding="10" Background="LightYellow" />
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Duplicate Dosage Warning Overlay -->
        <Border x:Name="WarningPanel" Grid.ColumnSpan="2" Visibility="Collapsed"
            Background="#CC8B0000" BorderBrush="DarkRed" BorderThickness="5"
            Padding="30" Margin="50" VerticalAlignment="Center" HorizontalAlignment="Center"
            MinWidth="600">
            <StackPanel>
                <TextBlock Text="⚠ DUPLICATE DOSAGE WARNING ⚠"
                    FontSize="28" FontWeight="Bold" Margin="0,0,0,20"
                    TextAlignment="Center" Foreground="White" />
                <TextBlock x:Name="WarningContent" FontSize="16"
                    FontWeight="SemiBold" TextWrapping="Wrap"
                    Margin="0,0,0,20" Foreground="White" TextAlignment="Center" />
                <TextBlock x:Name="WarningTimer" Text="This warning will close in 10 seconds"
                    FontSize="14" FontStyle="Italic" TextAlignment="Center"
                    Foreground="Yellow" />
            </StackPanel>
        </Border>

        <!-- Success Panel Overlay -->
        <Border x:Name="SuccessPanel" Grid.ColumnSpan="2" Visibility="Collapsed"
            Background="#CC228B22" BorderBrush="DarkGreen" BorderThickness="5"
            Padding="30" Margin="50" VerticalAlignment="Center" HorizontalAlignment="Center"
            MinWidth="600">
            <StackPanel>
                <TextBlock Text="✓ MEDICATION TAKEN SUCCESSFULLY ✓"
                    FontSize="28" FontWeight="Bold" Margin="0,0,0,20"
                    TextAlignment="Center" Foreground="White" />
                <TextBlock x:Name="SuccessContent" FontSize="16"
                    FontWeight="SemiBold" TextWrapping="Wrap"
                    Margin="0,0,0,20" Foreground="White" TextAlignment="Center" />
                <TextBlock x:Name="SuccessTimer" Text="This message will close in 5 seconds"
                    FontSize="14" FontStyle="Italic" TextAlignment="Center"
                    Foreground="LightGreen" />
            </StackPanel>
        </Border>
    </Grid>
</Window>